import { useEthersSigner } from './getSigner'
import { useCallback } from 'react';
import { ethers } from 'ethers';
import contractABI from './abi.json'

import { Button } from "./components/ui/button"

const contractBytecode = "0x608060405234801561001057600080fd5b50604051611f13380380611f1383398101604081905261002f91610112565b8181600061003d8382610200565b50600161004a8282610200565b50505050506102bf565b634e487b7160e01b600052604160045260246000fd5b600082601f83011261007b57600080fd5b81516001600160401b038082111561009557610095610054565b604051601f8301601f19908116603f011681019082821181831017156100bd576100bd610054565b81604052838152602092508660208588010111156100da57600080fd5b600091505b838210156100fc57858201830151818301840152908201906100df565b6000602085830101528094505050505092915050565b6000806040838503121561012557600080fd5b82516001600160401b038082111561013c57600080fd5b6101488683870161006a565b9350602085015191508082111561015e57600080fd5b5061016b8582860161006a565b9150509250929050565b600181811c9082168061018957607f821691505b6020821081036101a957634e487b7160e01b600052602260045260246000fd5b50919050565b601f8211156101fb576000816000526020600020601f850160051c810160208610156101d85750805b601f850160051c820191505b818110156101f7578281556001016101e4565b5050505b505050565b81516001600160401b0381111561021957610219610054565b61022d816102278454610175565b846101af565b602080601f831160018114610262576000841561024a5750858301515b600019600386901b1c1916600185901b1785556101f7565b600085815260208120601f198616915b8281101561029157888601518255948401946001909101908401610272565b50858210156102af5787850151600019600388901b60f8161c191681555b5050505050600190811b01905550565b611c45806102ce6000396000f3fe608060405234801561001057600080fd5b50600436106101165760003560e01c80636352211e116100a2578063a22cb46511610071578063a22cb46514610255578063b88d4fde14610268578063c87b56dd1461027b578063d61019801461028e578063e985e9c51461029657600080fd5b80636352211e146102045780636804a9581461021757806370a082311461022c57806395d89b411461024d57600080fd5b8063081812fc116100e9578063081812fc1461018d578063095ea7b3146101b85780631b3efe85146101cb57806323b872dd146101de57806342842e0e146101f157600080fd5b806301ffc9a71461011b5780630471735814610143578063059dfe131461016357806306fdde0314610178575b600080fd5b61012e6101293660046115ad565b6102a9565b60405190151581526020015b60405180910390f35b6101566101513660046115ca565b6102d4565b60405161013a91906115e3565b6101766101713660046116f1565b610466565b005b610180610527565b60405161013a9190611776565b6101a061019b3660046115ca565b6105b9565b6040516001600160a01b03909116815260200161013a565b6101766101c63660046117a5565b6105e2565b6101766101d93660046117cf565b6105f1565b6101766101ec366004611816565b610763565b6101766101ff366004611816565b6107ee565b6101a06102123660046115ca565b61080e565b61021f610819565b60405161013a9190611852565b61023f61023a3660046118de565b6109bb565b60405190815260200161013a565b610180610a03565b6101766102633660046118f9565b610a12565b610176610276366004611935565b610a1d565b6101806102893660046115ca565b610a34565b61021f610b45565b61012e6102a43660046119b1565b610d7c565b60006001600160e01b03198216632483248360e11b14806102ce57506102ce82610daa565b92915050565b6000818152600b6020908152604080832080548251818502810185019093528083526060949383018282801561032957602002820191906000526020600020905b815481526020019060010190808311610315575b505050505090506000815167ffffffffffffffff81111561034c5761034c611645565b6040519080825280602002602001820160405280156103aa57816020015b6103976040518060600160405280600081526020016000815260200160006001600160a01b031681525090565b81526020019060019003908161036a5790505b50905060005b825181101561045e576000600a60008584815181106103d1576103d16119e4565b6020026020010151815260200190815260200160002090508060405180606001604052908160008201548152602001600182015481526020016002820160009054906101000a90046001600160a01b03166001600160a01b03166001600160a01b03168152505083838151811061044a5761044a6119e4565b6020908102919091010152506001016103b0565b509392505050565b610474600880546001019055565b600061047f60085490565b6040805160608101825282815260208082018681523383850152600085815260099092529290208151815591519293509160018201906104bf9082611a84565b5060409182015160029190910180546001600160a01b0319166001600160a01b0390921691909117905551339082907f28264f4036324f7af9abd02761740048265f0c980737a3f97365dad3162cbe659061051b908690611776565b60405180910390a35050565b606060008054610536906119fa565b80601f0160208091040260200160405190810160405280929190818152602001828054610562906119fa565b80156105af5780601f10610584576101008083540402835291602001916105af565b820191906000526020600020905b81548152906001019060200180831161059257829003601f168201915b5050505050905090565b60006105c482610dfa565b506000828152600460205260409020546001600160a01b03166102ce565b6105ed828233610e33565b5050565b6000828152600960205260409020600201546001600160a01b0316331461067c5760405162461bcd60e51b815260206004820152603460248201527f596f75206d757374206f776e2074686520636f6c6c656374696f6e20746f20636044820152733932b0ba329030903a37b5b2b71034b71034ba1760611b60648201526084015b60405180910390fd5b61068a600780546001019055565b600061069560075490565b90506106a13382610e40565b6106ab8183610e5a565b604080516060810182528281526020808201868152338385018181526000878152600a85528681209551865592516001808701919091559051600290950180546001600160a01b0319166001600160a01b0390961695909517909455878252600b83528482208054948501815582529190209091018390559051849083907f38c57b6c4228d1f7c0c7b22c24aea16a8a5d3ba1e6ea2df92b7886554876703e90610756908790611776565b60405180910390a4505050565b6001600160a01b03821661078d57604051633250574960e11b815260006004820152602401610673565b600061079a838333610eaa565b9050836001600160a01b0316816001600160a01b0316146107e8576040516364283d7b60e01b81526001600160a01b0380861660048301526024820184905282166044820152606401610673565b50505050565b61080983838360405180602001604052806000815250610a1d565b505050565b60006102ce82610dfa565b6060600061082660085490565b905060008167ffffffffffffffff81111561084357610843611645565b6040519080825280602002602001820160405280156108a157816020015b61088e6040518060600160405280600081526020016060815260200160006001600160a01b031681525090565b8152602001906001900390816108615790505b50905060005b828110156109b45760006009816108bf846001611b5a565b8152602001908152602001600020905080604051806060016040529081600082015481526020016001820180546108f5906119fa565b80601f0160208091040260200160405190810160405280929190818152602001828054610921906119fa565b801561096e5780601f106109435761010080835404028352916020019161096e565b820191906000526020600020905b81548152906001019060200180831161095157829003601f168201915b5050509183525050600291909101546001600160a01b031660209091015283518490849081106109a0576109a06119e4565b6020908102919091010152506001016108a7565b5092915050565b60006001600160a01b0382166109e7576040516322718ad960e21b815260006004820152602401610673565b506001600160a01b031660009081526003602052604090205490565b606060018054610536906119fa565b6105ed338383610fa3565b610a28848484610763565b6107e884848484611042565b6060610a3f82610dfa565b5060008281526006602052604081208054610a59906119fa565b80601f0160208091040260200160405190810160405280929190818152602001828054610a85906119fa565b8015610ad25780601f10610aa757610100808354040283529160200191610ad2565b820191906000526020600020905b815481529060010190602001808311610ab557829003601f168201915b505050505090506000610af060408051602081019091526000815290565b90508051600003610b02575092915050565b815115610b34578082604051602001610b1c929190611b6d565b60405160208183030381529060405292505050919050565b610b3d8461116b565b949350505050565b60606000610b5260085490565b90506000805b82811015610ba8573360096000610b70846001611b5a565b81526020810191909152604001600020600201546001600160a01b031603610ba05781610b9c81611b9c565b9250505b600101610b58565b5060008167ffffffffffffffff811115610bc457610bc4611645565b604051908082528060200260200182016040528015610c2257816020015b610c0f6040518060600160405280600081526020016060815260200160006001600160a01b031681525090565b815260200190600190039081610be25790505b5090506000805b84811015610d72573360096000610c41846001611b5a565b81526020810191909152604001600020600201546001600160a01b031603610d6a5760096000610c72836001611b5a565b815260200190815260200160002060405180606001604052908160008201548152602001600182018054610ca5906119fa565b80601f0160208091040260200160405190810160405280929190818152602001828054610cd1906119fa565b8015610d1e5780601f10610cf357610100808354040283529160200191610d1e565b820191906000526020600020905b815481529060010190602001808311610d0157829003601f168201915b5050509183525050600291909101546001600160a01b03166020909101528351849084908110610d5057610d506119e4565b60200260200101819052508180610d6690611b9c565b9250505b600101610c29565b5090949350505050565b6001600160a01b03918216600090815260056020908152604080832093909416825291909152205460ff1690565b60006001600160e01b031982166380ac58cd60e01b1480610ddb57506001600160e01b03198216635b5e139f60e01b145b806102ce57506301ffc9a760e01b6001600160e01b03198316146102ce565b6000818152600260205260408120546001600160a01b0316806102ce57604051637e27328960e01b815260048101849052602401610673565b61080983838360016111e0565b6105ed8282604051806020016040528060008152506112e6565b6000828152600660205260409020610e728282611a84565b506040518281527ff8e1a15aba9398e019f0b49df1a4fde98ee17ae345cb5f6b5e2c27f5033e8ce79060200160405180910390a15050565b6000828152600260205260408120546001600160a01b0390811690831615610ed757610ed78184866112fd565b6001600160a01b03811615610f1557610ef46000856000806111e0565b6001600160a01b038116600090815260036020526040902080546000190190555b6001600160a01b03851615610f44576001600160a01b0385166000908152600360205260409020805460010190555b60008481526002602052604080822080546001600160a01b0319166001600160a01b0389811691821790925591518793918516917fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef91a4949350505050565b6001600160a01b038216610fd557604051630b61174360e31b81526001600160a01b0383166004820152602401610673565b6001600160a01b03838116600081815260056020908152604080832094871680845294825291829020805460ff191686151590811790915591519182527f17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c31910160405180910390a3505050565b6001600160a01b0383163b156107e857604051630a85bd0160e11b81526001600160a01b0384169063150b7a0290611084903390889087908790600401611bb5565b6020604051808303816000875af19250505080156110bf575060408051601f3d908101601f191682019092526110bc91810190611bf2565b60015b611128573d8080156110ed576040519150601f19603f3d011682016040523d82523d6000602084013e6110f2565b606091505b50805160000361112057604051633250574960e11b81526001600160a01b0385166004820152602401610673565b805181602001fd5b6001600160e01b03198116630a85bd0160e11b1461116457604051633250574960e11b81526001600160a01b0385166004820152602401610673565b5050505050565b606061117682610dfa565b50600061118e60408051602081019091526000815290565b905060008151116111ae57604051806020016040528060008152506111d9565b806111b884611361565b6040516020016111c9929190611b6d565b6040516020818303038152906040525b9392505050565b80806111f457506001600160a01b03821615155b156112b657600061120484610dfa565b90506001600160a01b038316158015906112305750826001600160a01b0316816001600160a01b031614155b801561124357506112418184610d7c565b155b1561126c5760405163a9fbf51f60e01b81526001600160a01b0384166004820152602401610673565b81156112b45783856001600160a01b0316826001600160a01b03167f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b92560405160405180910390a45b505b5050600090815260046020526040902080546001600160a01b0319166001600160a01b0392909216919091179055565b6112f083836113f4565b6108096000848484611042565b611308838383611459565b610809576001600160a01b03831661133657604051637e27328960e01b815260048101829052602401610673565b60405163177e802f60e01b81526001600160a01b038316600482015260248101829052604401610673565b6060600061136e836114bc565b600101905060008167ffffffffffffffff81111561138e5761138e611645565b6040519080825280601f01601f1916602001820160405280156113b8576020820181803683370190505b5090508181016020015b600019016f181899199a1a9b1b9c1cb0b131b232b360811b600a86061a8153600a85049450846113c257509392505050565b6001600160a01b03821661141e57604051633250574960e11b815260006004820152602401610673565b600061142c83836000610eaa565b90506001600160a01b03811615610809576040516339e3563760e11b815260006004820152602401610673565b60006001600160a01b03831615801590610b3d5750826001600160a01b0316846001600160a01b0316148061149357506114938484610d7c565b80610b3d5750506000908152600460205260409020546001600160a01b03908116911614919050565b60008072184f03e93ff9f4daa797ed6e38ed64bf6a1f0160401b83106114fb5772184f03e93ff9f4daa797ed6e38ed64bf6a1f0160401b830492506040015b6d04ee2d6d415b85acef81000000008310611527576d04ee2d6d415b85acef8100000000830492506020015b662386f26fc10000831061154557662386f26fc10000830492506010015b6305f5e100831061155d576305f5e100830492506008015b612710831061157157612710830492506004015b60648310611583576064830492506002015b600a83106102ce5760010192915050565b6001600160e01b0319811681146115aa57600080fd5b50565b6000602082840312156115bf57600080fd5b81356111d981611594565b6000602082840312156115dc57600080fd5b5035919050565b602080825282518282018190526000919060409081850190868401855b828110156116385781518051855286810151878601528501516001600160a01b03168585015260609093019290850190600101611600565b5091979650505050505050565b634e487b7160e01b600052604160045260246000fd5b600067ffffffffffffffff8084111561167657611676611645565b604051601f8501601f19908116603f0116810190828211818310171561169e5761169e611645565b816040528093508581528686860111156116b757600080fd5b858560208301376000602087830101525050509392505050565b600082601f8301126116e257600080fd5b6111d98383356020850161165b565b60006020828403121561170357600080fd5b813567ffffffffffffffff81111561171a57600080fd5b610b3d848285016116d1565b60005b83811015611741578181015183820152602001611729565b50506000910152565b60008151808452611762816020860160208601611726565b601f01601f19169290920160200192915050565b6020815260006111d9602083018461174a565b80356001600160a01b03811681146117a057600080fd5b919050565b600080604083850312156117b857600080fd5b6117c183611789565b946020939093013593505050565b600080604083850312156117e257600080fd5b82359150602083013567ffffffffffffffff81111561180057600080fd5b61180c858286016116d1565b9150509250929050565b60008060006060848603121561182b57600080fd5b61183484611789565b925061184260208501611789565b9150604084013590509250925092565b600060208083018184528085518083526040925060408601915060408160051b87010184880160005b838110156118d057603f19898403018552815160608151855288820151818a8701526118a98287018261174a565b928901516001600160a01b031695890195909552509487019492509086019060010161187b565b509098975050505050505050565b6000602082840312156118f057600080fd5b6111d982611789565b6000806040838503121561190c57600080fd5b61191583611789565b91506020830135801515811461192a57600080fd5b809150509250929050565b6000806000806080858703121561194b57600080fd5b61195485611789565b935061196260208601611789565b925060408501359150606085013567ffffffffffffffff81111561198557600080fd5b8501601f8101871361199657600080fd5b6119a58782356020840161165b565b91505092959194509250565b600080604083850312156119c457600080fd5b6119cd83611789565b91506119db60208401611789565b90509250929050565b634e487b7160e01b600052603260045260246000fd5b600181811c90821680611a0e57607f821691505b602082108103611a2e57634e487b7160e01b600052602260045260246000fd5b50919050565b601f821115610809576000816000526020600020601f850160051c81016020861015611a5d5750805b601f850160051c820191505b81811015611a7c57828155600101611a69565b505050505050565b815167ffffffffffffffff811115611a9e57611a9e611645565b611ab281611aac84546119fa565b84611a34565b602080601f831160018114611ae75760008415611acf5750858301515b600019600386901b1c1916600185901b178555611a7c565b600085815260208120601f198616915b82811015611b1657888601518255948401946001909101908401611af7565b5085821015611b345787850151600019600388901b60f8161c191681555b5050505050600190811b01905550565b634e487b7160e01b600052601160045260246000fd5b808201808211156102ce576102ce611b44565b60008351611b7f818460208801611726565b835190830190611b93818360208801611726565b01949350505050565b600060018201611bae57611bae611b44565b5060010190565b6001600160a01b0385811682528416602082015260408101839052608060608201819052600090611be89083018461174a565b9695505050505050565b600060208284031215611c0457600080fd5b81516111d98161159456fea2646970667358221220f3384fab109ebf41f8627c569dce02c7f7409ec08ac181323614d19623c5225664736f6c63430008190033";

interface DeployContractProps {
  contractArg1: string;
  contractArg2: string;
    className?: string;
}

const DeployContract: React.FC<DeployContractProps> = ({ contractArg1, contractArg2, className }) => {
  const signer = useEthersSigner();

  const deployContract = useCallback(async () => {
    if (!signer) return

    try {
      const factory = new ethers.ContractFactory(contractABI, contractBytecode, signer)
      const contract = await factory.deploy(contractArg1, contractArg2)
      await contract.deployed()
      console.log('Contract deployed to:', contract.address)
    } catch (error) {
      console.log("Transaction cancelled.")
    }
  }, [signer, contractArg1, contractArg2]); // Add contract arguments as dependencies

  // Removed useEffect to prevent automatic deployment

  return (
    <div>
      <Button className={`bg-green-600 hover:bg-green-900 ${className}`} onClick={deployContract}>Deploy Contract</Button>
    </div>
  );
};

export default DeployContract;
