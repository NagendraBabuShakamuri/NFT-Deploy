import { useEthersSigner } from './getSigner'
import { useCallback } from 'react';
import { ethers } from 'ethers';
import contractABI from './abi.json'

import { Button } from "./components/ui/button"

const contractBytecode = "0x608060405234801561001057600080fd5b50600436106101215760003560e01c80636352211e116100ad578063b88d4fde11610071578063b88d4fde14610268578063c87b56dd1461027b578063e0391b091461028e578063e985e9c514610296578063ef2d1746146102a957600080fd5b80636352211e1461021457806370a082311461022757806395d89b411461023a57806398c3df1614610242578063a22cb4651461025557600080fd5b8063095ea7b3116100f4578063095ea7b3146101a357806323b872dd146101b857806342842e0e146101cb57806345576f94146101de578063629cb2e4146101ff57600080fd5b806301ffc9a714610126578063066937711461014e57806306fdde0314610163578063081812fc14610178575b600080fd5b610139610134366004611577565b6102b1565b60405190151581526020015b60405180910390f35b6101566102dc565b6040516101459190611615565b61016b6103c4565b6040516101459190611628565b61018b61018636600461163b565b610456565b6040516001600160a01b039091168152602001610145565b6101b66101b1366004611670565b61047f565b005b6101b66101c636600461169a565b61048e565b6101b66101d936600461169a565b61051e565b6101f16101ec366004611762565b61053e565b604051908152602001610145565b6102076105d4565b60405161014591906117ab565b61018b61022236600461163b565b6107eb565b6101f161023536600461180f565b6107f6565b61016b61083e565b61015661025036600461163b565b61084d565b6101b661026336600461182a565b610928565b6101b6610276366004611866565b610933565b61016b61028936600461163b565b61094a565b610207610a5b565b6101396102a43660046118e2565b610be9565b6101f1610c17565b60006001600160e01b03198216632483248360e11b14806102d657506102d682610c27565b92915050565b6102e4611534565b60006102ef60085490565b60008181526009602090815260409182902082516060810184528154815260018201546001600160a01b031692810192909252600281018054949550919390928401919061033c90611915565b80601f016020809104026020016040519081016040528092919081815260200182805461036890611915565b80156103b55780601f1061038a576101008083540402835291602001916103b5565b820191906000526020600020905b81548152906001019060200180831161039857829003601f168201915b50505050508152505091505090565b6060600080546103d390611915565b80601f01602080910402602001604051908101604052809291908181526020018280546103ff90611915565b801561044c5780601f106104215761010080835404028352916020019161044c565b820191906000526020600020905b81548152906001019060200180831161042f57829003601f168201915b5050505050905090565b600061046182610c77565b506000828152600460205260409020546001600160a01b03166102d6565b61048a828233610cb0565b5050565b6001600160a01b0382166104bd57604051633250574960e11b8152600060048201526024015b60405180910390fd5b60006104ca838333610cbd565b9050836001600160a01b0316816001600160a01b031614610518576040516364283d7b60e01b81526001600160a01b03808616600483015260248201849052821660448201526064016104b4565b50505050565b61053983838360405180602001604052806000815250610933565b505050565b6007546000906001600160a01b0316331461059b5760405162461bcd60e51b815260206004820152601b60248201527f4f776e65722063616e206f6e6c792063726561746520746f6b656e000000000060448201526064016104b4565b6105a9600880546001019055565b60006105b460085490565b90506105c03382610db6565b6105ca8184610dd0565b6102d68184610e20565b606060006105e160085490565b905060008060005b8381101561063957336009600061060184600161194f565b81526020810191909152604001600020600101546001600160a01b0316036106315761062e60018461194f565b92505b6001016105e9565b5060008267ffffffffffffffff811115610655576106556116d6565b60405190808252806020026020018201604052801561068e57816020015b61067b611534565b8152602001906001900390816106735790505b50905060005b848110156107e25733600960006106ac84600161194f565b81526020810191909152604001600020600101546001600160a01b0316036107da5760006106db82600161194f565b60008181526009602090815260409182902082516060810184528154815260018201546001600160a01b031692810192909252600281018054949550909391928492908401919061072b90611915565b80601f016020809104026020016040519081016040528092919081815260200182805461075790611915565b80156107a45780601f10610779576101008083540402835291602001916107a4565b820191906000526020600020905b81548152906001019060200180831161078757829003601f168201915b5050505050815250508486815181106107bf576107bf611970565b60209081029190910101526107d560018661194f565b945050505b600101610694565b50949350505050565b60006102d682610c77565b60006001600160a01b038216610822576040516322718ad960e21b8152600060048201526024016104b4565b506001600160a01b031660009081526003602052604090205490565b6060600180546103d390611915565b610855611534565b60008281526009602090815260409182902082516060810184528154815260018201546001600160a01b031692810192909252600281018054929391929184019161089f90611915565b80601f01602080910402602001604051908101604052809291908181526020018280546108cb90611915565b80156109185780601f106108ed57610100808354040283529160200191610918565b820191906000526020600020905b8154815290600101906020018083116108fb57829003601f168201915b5050505050815250509050919050565b61048a338383610e93565b61093e84848461048e565b61051884848484610f32565b606061095582610c77565b506000828152600660205260408120805461096f90611915565b80601f016020809104026020016040519081016040528092919081815260200182805461099b90611915565b80156109e85780601f106109bd576101008083540402835291602001916109e8565b820191906000526020600020905b8154815290600101906020018083116109cb57829003601f168201915b505050505090506000610a0660408051602081019091526000815290565b90508051600003610a18575092915050565b815115610a4a578082604051602001610a32929190611986565b60405160208183030381529060405292505050919050565b610a538461105b565b949350505050565b60606000610a6860085490565b905060008167ffffffffffffffff811115610a8557610a856116d6565b604051908082528060200260200182016040528015610abe57816020015b610aab611534565b815260200190600190039081610aa35790505b5090506000805b83811015610be0576000610ada82600161194f565b60008181526009602090815260409182902082516060810184528154815260018201546001600160a01b0316928101929092526002810180549495509093919284929084019190610b2a90611915565b80601f0160208091040260200160405190810160405280929190818152602001828054610b5690611915565b8015610ba35780601f10610b7857610100808354040283529160200191610ba3565b820191906000526020600020905b815481529060010190602001808311610b8657829003601f168201915b505050505081525050858581518110610bbe57610bbe611970565b6020908102919091010152610bd460018561194f565b93505050600101610ac5565b50909392505050565b6001600160a01b03918216600090815260056020908152604080832093909416825291909152205460ff1690565b6000610c2260085490565b905090565b60006001600160e01b031982166380ac58cd60e01b1480610c5857506001600160e01b03198216635b5e139f60e01b145b806102d657506301ffc9a760e01b6001600160e01b03198316146102d6565b6000818152600260205260408120546001600160a01b0316806102d657604051637e27328960e01b8152600481018490526024016104b4565b61053983838360016110d0565b6000828152600260205260408120546001600160a01b0390811690831615610cea57610cea8184866111d6565b6001600160a01b03811615610d2857610d076000856000806110d0565b6001600160a01b038116600090815260036020526040902080546000190190555b6001600160a01b03851615610d57576001600160a01b0385166000908152600360205260409020805460010190555b60008481526002602052604080822080546001600160a01b0319166001600160a01b0389811691821790925591518793918516917fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef91a4949350505050565b61048a82826040518060200160405280600081525061123a565b6000828152600660205260409020610de88282611a05565b506040518281527ff8e1a15aba9398e019f0b49df1a4fde98ee17ae345cb5f6b5e2c27f5033e8ce79060200160405180910390a15050565b60408051606081018252838152336020808301918252828401858152600087815260099092529390208251815590516001820180546001600160a01b0319166001600160a01b0390921691909117905591519091906002820190610e849082611a05565b5090505061048a333384611251565b6001600160a01b038216610ec557604051630b61174360e31b81526001600160a01b03831660048201526024016104b4565b6001600160a01b03838116600081815260056020908152604080832094871680845294825291829020805460ff191686151590811790915591519182527f17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c31910160405180910390a3505050565b6001600160a01b0383163b1561051857604051630a85bd0160e11b81526001600160a01b0384169063150b7a0290610f74903390889087908790600401611ac5565b6020604051808303816000875af1925050508015610faf575060408051601f3d908101601f19168201909252610fac91810190611b02565b60015b611018573d808015610fdd576040519150601f19603f3d011682016040523d82523d6000602084013e610fe2565b606091505b50805160000361101057604051633250574960e11b81526001600160a01b03851660048201526024016104b4565b805181602001fd5b6001600160e01b03198116630a85bd0160e11b1461105457604051633250574960e11b81526001600160a01b03851660048201526024016104b4565b5050505050565b606061106682610c77565b50600061107e60408051602081019091526000815290565b9050600081511161109e57604051806020016040528060008152506110c9565b806110a884611301565b6040516020016110b9929190611986565b6040516020818303038152906040525b9392505050565b80806110e457506001600160a01b03821615155b156111a65760006110f484610c77565b90506001600160a01b038316158015906111205750826001600160a01b0316816001600160a01b031614155b801561113357506111318184610be9565b155b1561115c5760405163a9fbf51f60e01b81526001600160a01b03841660048201526024016104b4565b81156111a45783856001600160a01b0316826001600160a01b03167f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b92560405160405180910390a45b505b5050600090815260046020526040902080546001600160a01b0319166001600160a01b0392909216919091179055565b6111e1838383611394565b610539576001600160a01b03831661120f57604051637e27328960e01b8152600481018290526024016104b4565b60405163177e802f60e01b81526001600160a01b0383166004820152602481018290526044016104b4565b61124483836113f7565b6105396000848484610f32565b6001600160a01b03821661127b57604051633250574960e11b8152600060048201526024016104b4565b600061128983836000610cbd565b90506001600160a01b0381166112b557604051637e27328960e01b8152600481018390526024016104b4565b836001600160a01b0316816001600160a01b031614610518576040516364283d7b60e01b81526001600160a01b03808616600483015260248201849052821660448201526064016104b4565b6060600061130e8361145c565b600101905060008167ffffffffffffffff81111561132e5761132e6116d6565b6040519080825280601f01601f191660200182016040528015611358576020820181803683370190505b5090508181016020015b600019016f181899199a1a9b1b9c1cb0b131b232b360811b600a86061a8153600a850494508461136257509392505050565b60006001600160a01b03831615801590610a535750826001600160a01b0316846001600160a01b031614806113ce57506113ce8484610be9565b80610a535750506000908152600460205260409020546001600160a01b03908116911614919050565b6001600160a01b03821661142157604051633250574960e11b8152600060048201526024016104b4565b600061142f83836000610cbd565b90506001600160a01b03811615610539576040516339e3563760e11b8152600060048201526024016104b4565b60008072184f03e93ff9f4daa797ed6e38ed64bf6a1f0160401b831061149b5772184f03e93ff9f4daa797ed6e38ed64bf6a1f0160401b830492506040015b6d04ee2d6d415b85acef810000000083106114c7576d04ee2d6d415b85acef8100000000830492506020015b662386f26fc1000083106114e557662386f26fc10000830492506010015b6305f5e10083106114fd576305f5e100830492506008015b612710831061151157612710830492506004015b60648310611523576064830492506002015b600a83106102d65760010192915050565b60405180606001604052806000815260200160006001600160a01b03168152602001606081525090565b6001600160e01b03198116811461157457600080fd5b50565b60006020828403121561158957600080fd5b81356110c98161155e565b60005b838110156115af578181015183820152602001611597565b50506000910152565b600081518084526115d0816020860160208601611594565b601f01601f19169290920160200192915050565b8051825260018060a01b0360208201511660208301526000604082015160606040850152610a5360608501826115b8565b6020815260006110c960208301846115e4565b6020815260006110c960208301846115b8565b60006020828403121561164d57600080fd5b5035919050565b80356001600160a01b038116811461166b57600080fd5b919050565b6000806040838503121561168357600080fd5b61168c83611654565b946020939093013593505050565b6000806000606084860312156116af57600080fd5b6116b884611654565b92506116c660208501611654565b9150604084013590509250925092565b634e487b7160e01b600052604160045260246000fd5b600067ffffffffffffffff80841115611707576117076116d6565b604051601f8501601f19908116603f0116810190828211818310171561172f5761172f6116d6565b8160405280935085815286868601111561174857600080fd5b858560208301376000602087830101525050509392505050565b60006020828403121561177457600080fd5b813567ffffffffffffffff81111561178b57600080fd5b8201601f8101841361179c57600080fd5b610a53848235602084016116ec565b600060208083016020845280855180835260408601915060408160051b87010192506020870160005b8281101561180257603f198886030184526117f08583516115e4565b945092850192908501906001016117d4565b5092979650505050505050565b60006020828403121561182157600080fd5b6110c982611654565b6000806040838503121561183d57600080fd5b61184683611654565b91506020830135801515811461185b57600080fd5b809150509250929050565b6000806000806080858703121561187c57600080fd5b61188585611654565b935061189360208601611654565b925060408501359150606085013567ffffffffffffffff8111156118b657600080fd5b8501601f810187136118c757600080fd5b6118d6878235602084016116ec565b91505092959194509250565b600080604083850312156118f557600080fd5b6118fe83611654565b915061190c60208401611654565b90509250929050565b600181811c9082168061192957607f821691505b60208210810361194957634e487b7160e01b600052602260045260246000fd5b50919050565b808201808211156102d657634e487b7160e01b600052601160045260246000fd5b634e487b7160e01b600052603260045260246000fd5b60008351611998818460208801611594565b8351908301906119ac818360208801611594565b01949350505050565b601f821115610539576000816000526020600020601f850160051c810160208610156119de5750805b601f850160051c820191505b818110156119fd578281556001016119ea565b505050505050565b815167ffffffffffffffff811115611a1f57611a1f6116d6565b611a3381611a2d8454611915565b846119b5565b602080601f831160018114611a685760008415611a505750858301515b600019600386901b1c1916600185901b1785556119fd565b600085815260208120601f198616915b82811015611a9757888601518255948401946001909101908401611a78565b5085821015611ab55787850151600019600388901b60f8161c191681555b5050505050600190811b01905550565b6001600160a01b0385811682528416602082015260408101839052608060608201819052600090611af8908301846115b8565b9695505050505050565b600060208284031215611b1457600080fd5b81516110c98161155e56fea2646970667358221220223755170ecb12c229bc585e28abc06f5d4577fb01c756028acec1debf264b2264736f6c63430008190033";

interface DeployContractProps {
  contractArg1: string;
  contractArg2: string;
    className?: string;
}

const DeployContract: React.FC<DeployContractProps> = ({ contractArg1, contractArg2, className }) => {
  const signer = useEthersSigner();

  const deployContract = useCallback(async () => {
    if (!signer) return

    try {
      const factory = new ethers.ContractFactory(contractABI, contractBytecode, signer)
      const contract = await factory.deploy(contractArg1, contractArg2)
      await contract.deployed()
      console.log('Contract deployed to:', contract.address)
    } catch (error) {
      console.log("Transaction cancelled.")
    }
  }, [signer, contractArg1, contractArg2]); // Add contract arguments as dependencies

  // Removed useEffect to prevent automatic deployment

  return (
    <div>
      <Button className={`bg-green-600 hover:bg-green-900 ${className}`} onClick={deployContract}>Deploy Contract</Button>
    </div>
  );
};

export default DeployContract;
